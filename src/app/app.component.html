<div class="canvas"></div>

<div class="workspace" [ngStyle]="themeVars" (contextmenu)="openContextMenu($event, 'app', 'app')">
  <app-workspace-header
    [profileName]="profileName"
    [notebookCount]="notebookCount"
    [sectionCount]="sectionCount"
    [totalNotes]="totalNotes"
  />

  <main class="pane-grid">
    <app-notebooks-pane
      [notebooks]="notebooks"
      [selectedNotebookId]="selectedNotebookId"
      (createNotebook)="addNotebook()"
      (selectNotebook)="selectNotebook($event)"
      (renameNotebook)="renameNotebook($event)"
      (deleteNotebook)="deleteNotebook($event)"
      (contextMenuRequested)="openContextMenu($event.event, 'notebook', $event.targetId)"
    />

    <app-notes-pane
      [selectedNotebook]="selectedNotebook"
      [selectedSectionId]="selectedSectionId"
      [selectedNoteId]="selectedNoteId"
      [filteredNotes]="filteredNotes"
      [searchTerm]="searchTerm"
      [formatDate]="formatDate"
      (addSection)="addSection()"
      (addNote)="addNote()"
      (selectSection)="selectSection($event)"
      (renameSection)="renameSection($event)"
      (deleteSection)="deleteSection($event)"
      (selectNote)="selectNote($event)"
      (renameNote)="renameNote($event)"
      (deleteNote)="deleteNote($event)"
      (searchTermChange)="searchTerm = $event"
      (sectionContextMenuRequested)="openContextMenu($event.event, 'section', $event.targetId)"
      (noteContextMenuRequested)="openContextMenu($event.event, 'note', $event.targetId)"
    />

    <app-editor-pane
      [selectedNote]="selectedNote"
      [formatDate]="formatDate"
      (updateTitle)="updateSelectedNoteTitle($event)"
      (toggleFavorite)="toggleFavorite()"
      (deleteNote)="deleteNote($event)"
      (updateContent)="updateNoteContent($event)"
    />
  </main>
</div>

<app-context-menu
  [visible]="contextMenu.visible"
  [x]="contextMenu.x"
  [y]="contextMenu.y"
  [targetType]="contextMenu.targetType"
  (actionSelected)="handleContextAction($event)"
/>
